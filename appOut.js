var Calculator;!function(t){"use strict";!function(t){t[t.high=0]="high",t[t.low=1]="low"}(t.CircleCrossMode||(t.CircleCrossMode={}));var e=(t.CircleCrossMode,function(){function e(){}return e.prototype.circleCross=function(e,i,n,r,a){var s=this.length(i,n),o=Math.atan2(n.y-i.y,n.x-i.x),h=Math.acos(s/(2*r)),c=new t.Point(i.x+r*Math.cos(o+h),i.y+r*Math.sin(o+h)),l=new t.Point(i.x+r*Math.cos(o-h),i.y+r*Math.sin(o-h));return 0==a?this.length(e,c)>this.length(e,l)?this.length(e,c):this.length(e,l):1==a?this.length(e,c)<this.length(e,l)?this.length(e,c):this.length(e,l):void 0},e.prototype.length=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},e.prototype.distPointLine=function(e,i,n){var r=new t.Point(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2);return this.length(e,r)},e}());t.EuclideanService=e}(Calculator||(Calculator={}));var Calculator;!function(t){"use strict";var e=function(){function t(){}return t.prototype.period=function(t,e,i){return 2*Math.PI*Math.sqrt(Math.pow(t+e,3)/i)},t.prototype.nightTime=function(t,e,i){var n=t+e;return 2*Math.pow(n,2)/Math.sqrt(n*i)*Math.asin(t/n)},t.prototype.hohmannStartDV=function(t,e,i,n){var r=t+e,a=t+i;return Math.sqrt(n/r)*(Math.sqrt(2*a/(r+a))-1)},t.prototype.hohmannFinishDV=function(t,e,i,n){var r=t+e,a=t+i;return Math.sqrt(n/a)*(1-Math.sqrt(2*r/(r+a)))},t.prototype.slidePhaseAngle=function(t,e,i){return t/(1-e/i)},t}();t.OrbitalService=e}(Calculator||(Calculator={}));var Calculator;!function(t){var e=function(){function t(t,e){this.x=t,this.y=e}return t}();t.Point=e}(Calculator||(Calculator={}));var App;!function(t){var e=function(){function t(t,e,i,n,r){this.name=t,this.color=e,this.radius=i,this.stdGravity=n,this.soi=r}return t.prototype.clone=function(){return new t(this.name,this.color,this.radius,this.stdGravity,this.soi)},t}();t.Body=e}(App||(App={}));var App;!function(t){var e=function(){function t(t,e,i,n,r,a){this.body=t,this.count=e,this.altitude=i,this.elcNeeded=n,this.antenna=r,this.parkingAlt=a}return t}();t.SatChain=e}(App||(App={}));var App;!function(t){var e=function(){function t(t,e,i){this.stage=new createjs.Stage(t),this.shapeContainer=new createjs.Container,this.textContainer=new createjs.Container,this.stage.addChild(this.shapeContainer),this.stage.addChild(this.textContainer),this.virtualSize=e,this.realSize=i}return Object.defineProperty(t.prototype,"center",{get:function(){return new Calculator.Point(this.realSize/2,this.realSize/2)},enumerable:!0,configurable:!0}),t.prototype.toReal=function(t){return t*this.realSize/this.virtualSize},t.prototype.update=function(){this.stage.update()},t.fontSetNormal="16px Arial",t.fontSetBig="20px Arial",t.localeSetting={maximumFractionDigits:3},t.marginText=8,t.marginTextPushed=24,t.strokeLineWidth=1,t.dotRadius=4,t.arrowSize=16,t}();t.ViewService=e}(App||(App={}));var App;!function(t){var e=function(){function e(e,i){this.$cookieStore=e,this.cookieKey=i,this._stockAntennas={"Reflectron DP-10":new t.Antenna("Reflectron DP-10",0,500,.01),"Communotron 16":new t.Antenna("Communotron 16",0,2500,.13),"CommTech EXP-VR-2T":new t.Antenna("CommTech EXP-VR-2T",0,3e3,.18),"Communotron 32":new t.Antenna("Communotron 32",0,5e3,.6),"Comms DTS-M1":new t.Antenna("Comms DTS-M1",1,5e4,.82),"Reflectron KR-7":new t.Antenna("Reflectron KR-7",1,9e4,.82),"Communotron 88-88":new t.Antenna("Communotron 88-88",1,4e7,.93),"Reflectron KR-14":new t.Antenna("Reflectron KR-14",1,6e7,.93),"CommTech-1":new t.Antenna("CommTech-1",1,35e7,2.6),"Reflectron GX-128":new t.Antenna("Reflectron GX-128",1,4e8,2.8)},this.loadUserAntennas()}return Object.defineProperty(e.prototype,"stockAntennas",{get:function(){return this._stockAntennas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userAntennas",{get:function(){return this._userAntennas},enumerable:!0,configurable:!0}),e.prototype.loadUserAntennas=function(){this._userAntennas={};var e=this.$cookieStore.get(this.cookieKey);if(void 0!==e)for(var i in e){var n=e[i];this._userAntennas[n.name]=new t.Antenna(n.name,n.type,n.range,n.elcNeeded)}},e.prototype.save=function(){Object.keys(this.userAntennas).length>0?this.$cookieStore.put(this.cookieKey,this.userAntennas):this.$cookieStore.remove(this.cookieKey)},e.prototype.existsInStock=function(t){return-1!==Object.keys(this.stockAntennas).indexOf(t)},e.prototype.existsInUser=function(t){return-1!==Object.keys(this.userAntennas).indexOf(t)},e.prototype.getAntenna=function(t){return this.existsInStock(t)?this.stockAntennas[t].clone():this.existsInUser(t)?this.userAntennas[t].clone():void 0},e.prototype.setAntenna=function(t,e){this.userAntennas[t]=e.clone()},e.prototype.removeAntenna=function(t){delete this.userAntennas[t]},e.$inject=["$cookieStore","antennaStorageCookieKey"],e}();t.AntennaStorageService=e}(App||(App={}));var App;!function(t){var e=function(){function e(e,i){this.$cookieStore=e,this.cookieKey=i,this._stockBodies={Kerbol:new t.Body("Kerbol","rgb(255,242,0)",261600,1172332800,Number.POSITIVE_INFINITY),Moho:new t.Body("Moho","rgb(185,122,87)",250,168.60938,9646.663),Eve:new t.Body("Eve","rgb(163,73,164)",700,8171.7302,85109.365),Gilly:new t.Body("Gilly","rgb(239,228,176)",13,.0082894498,126.12327),Kerbin:new t.Body("Kerbin","rgb(63,111,40)",600,3531.6,84159.286),Mun:new t.Body("Mun","rgb(127,127,127)",200,65.138398,2429.5591),Minmus:new t.Body("Minmus","rgb(153,217,234)",60,1.7658,2247.4284),Duna:new t.Body("Duna","rgb(237,28,36)",320,301.36321,47921.949),Ike:new t.Body("Ike","rgb(127,127,127)",130,18.568369,1049.5989),Dres:new t.Body("Dres","rgb(195,195,195)",138,21.484489,32832.84),Jool:new t.Body("Jool","rgb(92,231,58)",6e3,282528,2455985.2),Laythe:new t.Body("Laythe","rgb(25,55,98)",500,1962,3723.6458),Vall:new t.Body("Vall","rgb(82,133,141)",300,207.4815,2406.4014),Tylo:new t.Body("Tylo","rgb(195,195,195)",600,4523.8934,10856.518),Bop:new t.Body("Bop","rgb(142,106,51)",65,2.4868349,1221.0609),Pol:new t.Body("Pol","rgb(206,211,1)",44,.72170208,1042.1389),Eeloo:new t.Body("Eeloo","rgb(221,221,210)",210,74.410815,119082.94)},this.loadUserBodies()}return Object.defineProperty(e.prototype,"stockBodies",{get:function(){return this._stockBodies},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userBodies",{get:function(){return this._userBodies},enumerable:!0,configurable:!0}),e.prototype.loadUserBodies=function(){this._userBodies={};var e=this.$cookieStore.get(this.cookieKey);if(void 0!==e)for(var i in e){var n=e[i];this._userBodies[n.name]=new t.Body(n.name,n.color,n.radius,n.stdGravity,n.soi)}},e.prototype.save=function(){Object.keys(this.userBodies).length>0?this.$cookieStore.put(this.cookieKey,this.userBodies):this.$cookieStore.remove(this.cookieKey)},e.prototype.existsInStock=function(t){return-1!==Object.keys(this.stockBodies).indexOf(t)},e.prototype.existsInUser=function(t){return-1!==Object.keys(this.userBodies).indexOf(t)},e.prototype.getBody=function(t){return this.existsInStock(t)?this.stockBodies[t].clone():this.existsInUser(t)?this.userBodies[t].clone():void 0},e.prototype.setBody=function(t,e){this.userBodies[t]=e.clone()},e.prototype.removeBody=function(t){delete this.userBodies[t]},e.$inject=["$cookieStore","bodyStorageCookieKey"],e}();t.BodyStorageService=e}(App||(App={}));var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},App;!function(t){var e=function(e){function i(n,r,a){e.call(this,n,5e3,400),this.deltavViewTarget=n,this.gHelper=r,this.satChainServ=a,this.shapeOuter=new createjs.Shape,this.shapeContainer.addChild(this.shapeOuter),this.txtDV1=new createjs.Text("",t.ViewService.fontSetNormal),this.txtDV1.textAlign="left",this.txtDV1.textBaseline="middle",this.txtDV1.x=this.center.x+i.parkingAltitude+t.ViewService.marginText,this.txtDV1.y=this.center.y,this.textContainer.addChild(this.txtDV1),this.txtDV2=new createjs.Text("",t.ViewService.fontSetNormal),this.txtDV2.textAlign="left",this.txtDV2.textBaseline="middle",this.txtDV2.x=this.center.x-i.designatedAltitude+t.ViewService.marginText,this.txtDV2.y=this.center.y,this.textContainer.addChild(this.txtDV2),this.txtDVTotal=new createjs.Text("",t.ViewService.fontSetNormal),this.txtDVTotal.textAlign="center",this.txtDVTotal.textBaseline="top",this.txtDVTotal.x=this.center.x,this.txtDVTotal.y=this.center.y+i.parkingAltitude+t.ViewService.marginText,this.textContainer.addChild(this.txtDVTotal),this.txtPhaseAngle=new createjs.Text("",t.ViewService.fontSetNormal),this.txtPhaseAngle.textAlign="center",this.txtPhaseAngle.textBaseline="bottom",this.txtPhaseAngle.x=this.center.x,this.txtPhaseAngle.y=this.center.y-i.designatedAltitude-t.ViewService.marginText,this.textContainer.addChild(this.txtPhaseAngle),this.txtPhaseTime=new createjs.Text("",t.ViewService.fontSetNormal),this.txtPhaseTime.textAlign="center",this.txtPhaseTime.textBaseline="top",this.txtPhaseTime.x=this.center.x,this.txtPhaseTime.y=this.center.y+i.designatedAltitude+t.ViewService.marginText,this.textContainer.addChild(this.txtPhaseTime),this.show()}return __extends(i,e),i.prototype.show=function(){this.shapeOuter.graphics.clear(),this.shapeOuter.graphics.setStrokeStyle(t.ViewService.strokeLineWidth),this.showFigures(this.shapeOuter.graphics,this.satChainServ),this.update()},i.prototype.showFigures=function(e,n){var r=n.satChain,a=r.body;this.shapeOuter.graphics.beginFill(a.color).drawCircle(this.center.x,this.center.y,i.bodyRadius).endFill(),this.shapeOuter.graphics.beginStroke("black").drawCircle(this.center.x,this.center.y,i.parkingAltitude).endStroke(),this.shapeOuter.graphics.beginStroke("black").drawCircle(this.center.x,this.center.y,i.designatedAltitude).endStroke(),this.shapeOuter.graphics.beginStroke("green").arc(this.center.x+(i.parkingAltitude-i.designatedAltitude)/2,this.center.y,(i.parkingAltitude+i.designatedAltitude)/2,0,Math.PI,!0).endStroke(),this.shapeOuter.graphics.beginStroke("green"),this.gHelper.drawArrow(this.shapeOuter.graphics,this.center.x+(i.parkingAltitude-i.designatedAltitude)/2,this.center.y-(i.parkingAltitude+i.designatedAltitude)/2,0,t.ViewService.arrowSize).endStroke(),this.txtDV1.text="Start dV:\n"+(1e3*n.hohmannStartDeltaV()).toLocaleString("en",t.ViewService.localeSetting)+" m/s",this.txtDV2.text="Finish dV:\n"+(1e3*n.hohmannFinishDeltaV()).toLocaleString("en",t.ViewService.localeSetting)+" m/s",this.txtDVTotal.text="Total dV: "+(1e3*(n.hohmannStartDeltaV()+n.hohmannFinishDeltaV())).toLocaleString("en",t.ViewService.localeSetting)+"m/s",this.shapeOuter.graphics.beginStroke("black").drawCircle(this.center.x-i.designatedAltitude,this.center.y,t.ViewService.dotRadius).endStroke(),this.shapeOuter.graphics.beginFill("black").drawCircle(this.center.x-Math.cos(i.neighborSatInterval)*i.designatedAltitude,this.center.y-Math.sin(i.neighborSatInterval)*i.designatedAltitude,t.ViewService.dotRadius).drawCircle(this.center.x-Math.cos(i.neighborSatInterval)*i.designatedAltitude,this.center.y+Math.sin(i.neighborSatInterval)*i.designatedAltitude,t.ViewService.dotRadius).endFill(),this.txtPhaseAngle.text="Slide angle: "+n.slidePhaseAngle().toLocaleString("en",t.ViewService.localeSetting)+" deg.",this.txtPhaseTime.text="Slide time: "+n.slidePhaseTime().toLocaleString("en",t.ViewService.localeSetting)+" sec."},i.bodyRadius=20,i.parkingAltitude=50,i.designatedAltitude=150,i.neighborSatInterval=Math.PI/3,i.$inject=["deltavViewTarget","graphicsHelperServ","satChainServ"],i}(t.ViewService);t.DeltavViewService=e}(App||(App={}));var App;!function(t){var e=function(e){function i(i,n,r){e.call(this,i,1e4,840),this.entireViewTarget=i,this.gHelper=n,this.satChainServ=r,this.shape=new createjs.Shape,this.shapeContainer.addChild(this.shape),this.txtBodyName=new createjs.Text("",t.ViewService.fontSetBig),this.txtBodyName.textAlign="center",this.txtBodyName.textBaseline="middle",this.txtBodyName.x=this.center.x,this.txtBodyName.y=this.center.y,this.textContainer.addChild(this.txtBodyName),this.txtBodySoI=new createjs.Text("",t.ViewService.fontSetNormal),this.txtBodySoI.textAlign="center",this.txtBodySoI.textBaseline="top",this.txtBodySoI.x=this.center.x,this.textContainer.addChild(this.txtBodySoI),this.txtSatAltitude=new createjs.Text("",t.ViewService.fontSetNormal),this.txtSatAltitude.textAlign="center",this.txtSatAltitude.textBaseline="top",this.txtSatAltitude.x=this.center.x,this.textContainer.addChild(this.txtSatAltitude),this.txtCommDistance=new createjs.Text("",t.ViewService.fontSetNormal),this.txtCommDistance.textAlign="left",this.txtCommDistance.textBaseline="top",this.textContainer.addChild(this.txtCommDistance),this.txtCommDistance2=new createjs.Text("",t.ViewService.fontSetNormal),this.txtCommDistance2.textAlign="right",this.txtCommDistance2.textBaseline="down",this.textContainer.addChild(this.txtCommDistance2),this.txtCommStableRange=new createjs.Text("",t.ViewService.fontSetNormal),this.txtCommStableRange.textAlign="center",this.txtCommStableRange.textBaseline="bottom",this.txtCommStableRange.x=this.center.x,this.textContainer.addChild(this.txtCommStableRange),this.show()}return __extends(i,e),i.prototype.show=function(){var e=this.satChainServ.satChain;this.virtualSize=2*(e.body.radius+e.altitude+e.antenna.range)*1.05,this.shape.graphics.clear(),this.shape.graphics.setStrokeStyle(t.ViewService.strokeLineWidth),this.showSatChain(this.shape.graphics,this.satChainServ),this.showBody(this.shape.graphics,this.satChainServ),this.update()},i.prototype.showBody=function(e,i){var n=i.satChain,r=n.body;e.beginFill(r.color).drawCircle(this.center.x,this.center.y,this.toReal(r.radius)).endFill(),this.txtBodyName.text=r.name,r.soi!=Number.POSITIVE_INFINITY?(e.beginStroke("yellow").drawCircle(this.center.x,this.center.y,this.toReal(r.soi-r.radius)).endStroke(),this.txtBodySoI.text="Sphere of Influence: "+(r.soi-r.radius).toLocaleString("en",t.ViewService.localeSetting)+" km",this.txtBodySoI.y=this.center.y+Math.max(this.toReal(r.soi-r.radius)+t.ViewService.marginText,this.toReal(r.radius+n.altitude)+t.ViewService.marginTextPushed),this.txtBodySoI.visible=!0):this.txtBodySoI.visible=!1},i.prototype.showSatChain=function(e,i){var n=i.satChain,r=n.body,a=n.antenna;e.beginStroke("black").drawCircle(this.center.x,this.center.y,this.toReal(n.altitude+r.radius)).endStroke(),this.txtSatAltitude.text="Altitude: "+n.altitude.toLocaleString("en",t.ViewService.localeSetting)+" km",this.txtSatAltitude.y=this.center.y+this.toReal(n.altitude+r.radius)+t.ViewService.marginText;for(var s=0;s<n.count;s++)e.beginFill("black").drawCircle(this.center.x+this.toReal(i.satPosition(s).x),this.center.y+this.toReal(i.satPosition(s).y),t.ViewService.dotRadius).endFill();for(var s=0;s<n.count;s++)e.beginFill("rgba(255,0,0,0.1)").drawCircle(this.center.x+this.toReal(i.satPosition(s).x),this.center.y+this.toReal(i.satPosition(s).y),this.toReal(a.range)).endFill();e.beginStroke(i.isNextSatConnectable()?"blue":"red"),this.gHelper.drawDualArrow(this.shape.graphics,this.center.x+this.toReal(i.satPosition(0).x),this.center.y+this.toReal(i.satPosition(0).y),this.center.x+this.toReal(i.satPosition(1).x),this.center.y+this.toReal(i.satPosition(1).y),t.ViewService.arrowSize).endStroke(),this.txtCommDistance.text="Distance: "+i.satDistance().toLocaleString("en",t.ViewService.localeSetting)+" km",this.txtCommDistance.x=this.center.x+this.toReal((i.satPosition(0).x+i.satPosition(1).x)/2)+t.ViewService.marginText/2,this.txtCommDistance.y=this.center.y+this.toReal((i.satPosition(0).y+i.satPosition(1).y)/2)+t.ViewService.marginText/2,n.count>4?(e.beginStroke(i.canConnectToSat(2)?"blue":"red"),this.gHelper.drawDualArrow(this.shape.graphics,this.center.x+this.toReal(i.satPosition(0).x),this.center.y+this.toReal(i.satPosition(0).y),this.center.x+this.toReal(i.satPosition(2).x),this.center.y+this.toReal(i.satPosition(2).y),t.ViewService.arrowSize).endStroke(),this.txtCommDistance2.text="Distance: "+i.satDistanceTo(2).toLocaleString("en",t.ViewService.localeSetting)+" km",this.txtCommDistance2.x=this.center.x+this.toReal((i.satPosition(0).x+i.satPosition(2).x)/2)-t.ViewService.marginText/2,this.txtCommDistance2.y=this.center.y+this.toReal((i.satPosition(0).y+i.satPosition(2).y)/2)-t.ViewService.marginText/2,this.txtCommDistance2.visible=!0):this.txtCommDistance2.visible=!1,i.hasStableArea()?(this.shape.graphics.beginStroke("green").drawCircle(this.center.x,this.center.y,this.toReal(i.stableLimitAltitude()+r.radius)).endStroke(),this.txtCommStableRange.text="Stable: "+i.stableLimitAltitude().toLocaleString("en",t.ViewService.localeSetting)+" km",this.txtCommStableRange.y=this.center.y-this.toReal(i.stableLimitAltitude()+r.radius)-t.ViewService.marginText):this.txtCommStableRange.text=""},i.$inject=["entireViewTarget","graphicsHelperServ","satChainServ"],i}(t.ViewService);t.EntireViewService=e}(App||(App={}));var App;!function(t){var e=function(){function t(){}return t.prototype.drawArrow=function(e,i,n,r,a){return e.moveTo(i,n).lineTo(i+a*Math.cos(r+t.arrowAngle),n+a*Math.sin(r+t.arrowAngle)).lineTo(i+a*Math.cos(r-t.arrowAngle),n+a*Math.sin(r-t.arrowAngle)).lineTo(i,n),e},t.prototype.drawDualArrow=function(t,e,i,n,r,a){var s=Math.atan2(r-i,n-e);return t.moveTo(e,i).lineTo(n,r),this.drawArrow(t,e,i,s,a),this.drawArrow(t,n,r,s+Math.PI,a),t},t.arrowAngle=Math.PI/6,t.$inject=[],t}();t.GraphicsHelperService=e}(App||(App={}));var App;!function(t){var e=function(e){function i(n,r){e.call(this,n,5e3,400),this.nightViewTarget=n,this.satChainServ=r,this.shapeOuter=new createjs.Shape,this.shapeContainer.addChild(this.shapeOuter),this.txtOrbitalPeriod=new createjs.Text("",t.ViewService.fontSetNormal),this.txtOrbitalPeriod.textAlign="center",this.txtOrbitalPeriod.textBaseline="bottom",this.txtOrbitalPeriod.x=this.center.x,this.txtOrbitalPeriod.y=this.center.y-i.orbitRadius-t.ViewService.marginText,this.textContainer.addChild(this.txtOrbitalPeriod),this.txtRequiredGenerator=new createjs.Text("",t.ViewService.fontSetNormal),this.txtRequiredGenerator.textAlign="center",this.txtRequiredGenerator.textBaseline="top",this.txtRequiredGenerator.x=this.center.x,this.txtRequiredGenerator.y=this.center.y+i.orbitRadius+t.ViewService.marginText,this.textContainer.addChild(this.txtRequiredGenerator),this.txtNightTime=new createjs.Text("",t.ViewService.fontSetNormal),this.txtNightTime.textAlign="right",this.txtNightTime.textBaseline="bottom",this.txtNightTime.x=this.realSize-t.ViewService.marginText,this.txtNightTime.y=this.center.y-i.bodyRadius-t.ViewService.marginText,this.textContainer.addChild(this.txtNightTime),this.txtRequiredBattery=new createjs.Text("",t.ViewService.fontSetNormal),this.txtRequiredBattery.textAlign="right",this.txtRequiredBattery.textBaseline="top",this.txtRequiredBattery.x=this.realSize-t.ViewService.marginText,this.txtRequiredBattery.y=this.center.y+i.bodyRadius+t.ViewService.marginText,this.textContainer.addChild(this.txtRequiredBattery),this.show()}return __extends(i,e),i.prototype.show=function(){this.shapeOuter.graphics.clear(),this.shapeOuter.graphics.setStrokeStyle(t.ViewService.strokeLineWidth),this.showFigures(this.shapeOuter.graphics,this.satChainServ),this.update()},i.prototype.showFigures=function(e,n){var r=n.satChain,a=r.body;this.shapeOuter.graphics.beginFill("rgba(0,0,0,0.2)").drawRect(this.center.x,this.center.y-i.bodyRadius,this.realSize/2,2*i.bodyRadius).endFill(),this.shapeOuter.graphics.beginFill(a.color).drawCircle(this.center.x,this.center.y,i.bodyRadius).endFill(),this.shapeOuter.graphics.beginStroke("gray").drawCircle(this.center.x,this.center.y,i.orbitRadius).endStroke(),this.txtOrbitalPeriod.text="Orbital period: "+n.orbitalPeriod().toLocaleString("en",t.ViewService.localeSetting)+" sec.",this.txtNightTime.text="Night time: "+n.nightTime().toLocaleString("en",t.ViewService.localeSetting)+" sec.",this.txtRequiredBattery.text="Required Battery: "+n.requiredBattery().toLocaleString("en",t.ViewService.localeSetting),this.txtRequiredGenerator.text="Required Generator: "+n.requiredGenerator().toLocaleString("en",t.ViewService.localeSetting)+" per sec."},i.bodyRadius=50,i.orbitRadius=150,i.$inject=["nightViewTarget","satChainServ"],i}(t.ViewService);t.NightViewService=e}(App||(App={}));var App;!function(t){var e=function(){function e(t,e,i,n){this.$cookieStore=t,this.cookieKey=e,this.euclideanServ=i,this.orbitalServ=n,this._satChain=this.loadOrCreate()}return Object.defineProperty(e.prototype,"satChain",{get:function(){return this._satChain},enumerable:!0,configurable:!0}),e.prototype.loadOrCreate=function(){var e=this.$cookieStore.get(this.cookieKey);return void 0!==e?e:new t.SatChain(new t.Body("Kerbin","rgb(63,111,40)",600,3531.6,84159.286),4,1e3,.029,new t.Antenna("Communotron 16",0,2500,.13),70)},e.prototype.save=function(){this.$cookieStore.put(this.cookieKey,this.satChain)},e.prototype.satPosition=function(t){var e=this.satChain.body.radius+this.satChain.altitude;return new Calculator.Point(e*Math.cos(2*Math.PI/this.satChain.count*t),+e*Math.sin(2*Math.PI/this.satChain.count*t))},e.prototype.satDistance=function(){return this.satDistanceTo(1)},e.prototype.satDistanceTo=function(t){return this.euclideanServ.length(this.satPosition(0),this.satPosition(t))},e.prototype.isNextSatConnectable=function(){return this.canConnectToSat(1)},e.prototype.canConnectToSat=function(t){return this.satChain.count>=t+1&&this.euclideanServ.length(this.satPosition(0),this.satPosition(t))<=this.satChain.antenna.range&&this.euclideanServ.distPointLine(new Calculator.Point(0,0),this.satPosition(0),this.satPosition(t))>this.satChain.body.radius},e.prototype.hasStableArea=function(){return this.satChain.count>=3&&this.isNextSatConnectable()},e.prototype.stableLimitAltitude=function(){return this.euclideanServ.circleCross(new Calculator.Point(0,0),this.satPosition(0),this.satPosition(1),this.satChain.antenna.range,0)-this.satChain.body.radius},e.prototype.orbitalPeriod=function(){return this.orbitalServ.period(this.satChain.body.radius,this.satChain.altitude,this.satChain.body.stdGravity)},e.prototype.nightTime=function(){return this.orbitalServ.nightTime(this.satChain.body.radius,this.satChain.altitude,this.satChain.body.stdGravity)},e.prototype.requiredBattery=function(){return(this.satChain.elcNeeded+this.satChain.antenna.elcNeeded)*this.nightTime()},e.prototype.requiredGenerator=function(){return(this.satChain.elcNeeded+this.satChain.antenna.elcNeeded)*this.orbitalPeriod()/(this.orbitalPeriod()-this.nightTime())},e.prototype.hohmannStartDeltaV=function(){return this.orbitalServ.hohmannStartDV(this.satChain.body.radius,this.satChain.parkingAlt,this.satChain.altitude,this.satChain.body.stdGravity)},e.prototype.hohmannFinishDeltaV=function(){return this.orbitalServ.hohmannFinishDV(this.satChain.body.radius,this.satChain.parkingAlt,this.satChain.altitude,this.satChain.body.stdGravity)},e.prototype.slidePhaseAngle=function(){var t=this.orbitalServ.period(this.satChain.body.radius,this.satChain.parkingAlt,this.satChain.body.stdGravity),e=this.orbitalServ.period(this.satChain.body.radius,this.satChain.altitude,this.satChain.body.stdGravity);return this.orbitalServ.slidePhaseAngle(360/this.satChain.count,t,e)},e.prototype.slidePhaseTime=function(){return this.slidePhaseAngle()/360*this.orbitalServ.period(this.satChain.body.radius,this.satChain.parkingAlt,this.satChain.body.stdGravity)},e.$inject=["$cookieStore","satChainCookieKey","calc.euclideanServ","calc.orbitalServ"],e}();t.SatChainService=e}(App||(App={}));var App;!function(t){var e=function(){function t(t,e,i){this.entireViewServ=t,this.nightViewServ=e,this.deltavViewServ=i}return t.prototype.updateView=function(){this.entireViewServ.show(),this.nightViewServ.show(),this.deltavViewServ.show()},t.$inject=["entireViewServ","nightViewServ","deltavViewServ"],t}();t.AppController=e}(App||(App={}));var App;!function(t){var e=function(){function e(t){this.bodyStorageServ=t,this.userBodies=t.userBodies,this.isInEdit=!1,this.editData=void 0}return e.prototype.exists=function(t){return this.bodyStorageServ.existsInStock(t)||this.bodyStorageServ.existsInUser(t)},e.prototype.add=function(){this.editData=new t.Body("","",0,0,0),this.isInEdit=!0},e.prototype.edit=function(t){this.editData=this.bodyStorageServ.getBody(t),this.isInEdit=!0},e.prototype.remove=function(t){this.isInEdit=!1,this.bodyStorageServ.removeBody(t),this.bodyStorageServ.save()},e.prototype.save=function(){this.isInEdit=!1,this.bodyStorageServ.setBody(this.editData.name,this.editData),this.bodyStorageServ.save()},e.prototype.cancel=function(){this.isInEdit=!1},e.$inject=["bodyStorageServ"],e}();t.BodyEditController=e}(App||(App={}));var App;!function(t){var e=function(){function e(t){this.antennaStorageServ=t,this.userAntennas=t.userAntennas,this.isInEdit=!1,this.editData=void 0}return e.prototype.exists=function(t){return this.antennaStorageServ.existsInStock(t)||this.antennaStorageServ.existsInUser(t)},e.prototype.add=function(){this.editData=new t.Antenna("",0,0,0),this.isInEdit=!0},e.prototype.edit=function(t){this.editData=this.antennaStorageServ.getAntenna(t),this.isInEdit=!0},e.prototype.remove=function(t){this.isInEdit=!1,this.antennaStorageServ.removeAntenna(t),this.antennaStorageServ.save()},e.prototype.save=function(){this.isInEdit=!1,this.antennaStorageServ.setAntenna(this.editData.name,this.editData),this.antennaStorageServ.save()},e.prototype.cancel=function(){this.isInEdit=!1},e.$inject=["antennaStorageServ"],e}();t.AntennaEditController=e}(App||(App={}));var App;!function(t){var e=function(){function e(e,i,n){this.satChainServ=e,this.bodies=i,this.antennas=n,this.satChain=this.satChainServ.satChain,this.antennaType=t.AntennaType}return e.prototype.save=function(){this.satChainServ.save()},e.prototype.pullBody=function(t){this.satChain.body=this.bodies.getBody(t)},e.prototype.pullAntenna=function(t){this.satChain.antenna=this.antennas.getAntenna(t)},e.$inject=["satChainServ","bodyStorageServ","antennaStorageServ"],e}();t.InputController=e}(App||(App={}));var App;!function(t){!function(t){t[t.omni=0]="omni",t[t.dish=1]="dish"}(t.AntennaType||(t.AntennaType={}));var e=(t.AntennaType,function(){function t(t,e,i,n){this.name=t,this.type=e,this.range=i,this.elcNeeded=n}return t.prototype.clone=function(){return new t(this.name,this.type,this.range,this.elcNeeded)},t.prototype.typeString=function(){return 0==this.type?"Omnidirectional":1==this.type?"Dish":""},t}());t.Antenna=e}(App||(App={}));var App;!function(t){angular.module("calc",[]).service("calc.euclideanServ",Calculator.EuclideanService).service("calc.orbitalServ",Calculator.OrbitalService),angular.module("app",["ngCookies","calc"]).value("bodyStorageCookieKey","userBody").value("antennaStorageCookieKey","userAntenna").value("satChainCookieKey","inputData").value("entireViewTarget","entire").value("nightViewTarget","night").value("deltavViewTarget","deltav").service("bodyStorageServ",t.BodyStorageService).service("antennaStorageServ",t.AntennaStorageService).service("satChainServ",t.SatChainService).service("graphicsHelperServ",t.GraphicsHelperService).service("entireViewServ",t.EntireViewService).service("nightViewServ",t.NightViewService).service("deltavViewServ",t.DeltavViewService).controller("inputCtrl",t.InputController).controller("bodyEditCtrl",t.BodyEditController).controller("antennaEditCtrl",t.AntennaEditController).controller("appCtrl",t.AppController)}(App||(App={}));